
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Proudly sponsored by Dusty the black cat">
      
      
        <meta name="author" content="Dan Choi">
      
      
        <link rel="canonical" href="https://github.com/daihan-ch22/daihan-ch22.github.io/blog/2022/10/26/deploy-https/">
      
      
        <link rel="prev" href="../../20/aws-s3-image-upload/">
      
      
        <link rel="next" href="../../31/github-actions-cicd/">
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>HTTPS붙여서 프로젝트 배포하기 - ddonddon</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-RJMESR2D6L"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-RJMESR2D6L",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-RJMESR2D6L",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#http" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="ddonddon" class="md-header__button md-logo" aria-label="ddonddon" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ddonddon
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HTTPS붙여서 프로젝트 배포하기
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../development/android/basic/EncryptedSharedPreferences231216/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="ddonddon" class="md-nav__button md-logo" aria-label="ddonddon" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ddonddon
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2022
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/life/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    life
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/self-review/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    self-review
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Android
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Android
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Basic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Basic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../development/android/basic/EncryptedSharedPreferences231216/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EncryptedSharedPreferences
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../development/android/basic/Overlay-Permission/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Requesting overlay permission
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../development/web/AwsS3ImageUpload221020/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS S3를 사용한 이미지 업로드
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#http" class="md-nav__link">
    <span class="md-ellipsis">
      http로는 위치 기능 사용 불가
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certbot" class="md-nav__link">
    <span class="md-ellipsis">
      Certbot 시도
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      분리 배포 방식으로 변경
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https-http" class="md-nav__link">
    <span class="md-ellipsis">
      https - http 통신?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadbalancer-route-53" class="md-nav__link">
    <span class="md-ellipsis">
      LoadBalancer와 Route 53
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      전체 흐름으로 보기
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2022-10-26 00:00:00+00:00" class="md-ellipsis">Wednesday, October 26, 2022</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/project/">project</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              5 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  




  <h1>HTTPS붙여서 프로젝트 배포하기</h1>

<pre><code>메인 프로젝트 관련 새로 배운 점 정리
</code></pre>
<p><strong>개인적으로 프로젝트를 하면서 가장 힘들었던 부분이었다.</strong> <br><br>
그래도 막상 찾아서 해보고 다른 팀원에게 설명하고 이렇게 정리를 해보니 처음보다 어느 정도 흐름에 대해서는 <br>
처음보다 감을 많이 잡은 것 같다. <br></p>
<p>다만 세부적인 개념들을 이해하고 진행한 게 아니라 작동이 되게 하는 것에 포커스를 두었었기 때문에 관련 개념들을 
한번 돌아볼 필요가 있다고 생각함. HTTPS 원리, 프록시 개념, 도메인/서브도메인 원리, HTTPS 통신 방식 등..<br></p>
<!-- more -->

<h2 id="http">http로는 위치 기능 사용 불가</h2>
<p>프리 프로젝트 당시에 아쉬웠던 점들 중 하나가 바로 https의 적용이었다.<br>
따라서 이번 메인 프로젝트에서는 꼭 사용해보고 싶었지만 일단 기능들을 전부 돌아가게 어느 정도 완성은 해놓고
시간이 남는다면 그때 붙이는 방향으로 정했었다.<br></p>
<p>일정의 중반쯤에 들어설 무렵 첫 배포를 진행해보기로 했다. 방식은 프리때와 마찬가지로 nginx로 리액트를 돌리고 
스프링은 내장 톰캣으로 돌리는 방식으로 정했다. <br> (비효율적인 방식이다 - 하지만 이때는 이 방법밖에 몰랐음)<br></p>
<p>그렇게 두 개의 서버가 돌아가고 위치정보를 받아오려 했는데 계속 받아지지 않았다. <br>
크롬 설정에서 보니 위치정보 허용 자체를 할 수 없도록 토글이 고정되어 있었다. <br>
알고 보니 <strong>거의 모든 브라우저에서 http를 사용하면 위치 정보를 받을 수 없도록 되어있었다는....</strong><br></p>
<p>우리는 위치정보를 GeoLocation으로 받아오기 때문에 https의 도입만이 방법이었다. <br>
이전에 시도했던 방식인 <a href="https://danc9921.tistory.com/177">GeoLite2를 사용해 IP 정보로 위치 정보를 따올 수 있었으나</a> 정확도가 떨어지고 <br>
영문 주소로 반환되는 문제가 있어 포기한 방식이다.<br></p>
<p>일정이 촉박한 상황에서 위치를 활용한 테스트를 빨리 해야 했기 때문에 바로 https를 붙이기로 정했다.<br></p>
<hr />
<h2 id="certbot">Certbot 시도</h2>
<p>https를 위해 certbot를 사용할 수 있다는 것을 프리 프로젝트때 검색해서 알고 있어 바로 도입해보았다. <br>
다만 <strong>문제는 나는 지금 하나의 EC2 인스턴스에 리액트와 스프링 둘 다 돌리고 있었기 때문</strong>에 nginx로 리액트를 배포하고 있는 
상황에서 어떤 식으로 접목을 시켜야 할지 감이 오지 않았다. <br><br>
백/프론트 각각 https를 붙이면 되지 않을까 하고 여기저기 찾아보며 진행했었지만 결국 실패했고 <br>
시간은 시간대로 허비하였다.<br></p>
<p>Certbot을 발급받아 nginx에 경로 지정하고, pem 키를 복사해서 .p12타입으로 바꾼뒤 스프링에 넣고 돌리는 방식이었다.
맞는 방식이라 생각했었지만, 포트나 요청URL 설정 같은 것들이 잘못되지 않았나 싶다. <br><br></p>
<p><em>지금 생각해보면 한 EC2 안에 백/프론트 서버가 공존한다는 게 좋은 방식은 아니었던 것 같다.</em> <br>
<em>예를들어, EC2가 먹통이 되더라도 사용자에게 이상이 있다라고 상황을 알려줘야 하는데 이걸 정적페이지에서 해야한다.</em> 
<em>근데 그 정적페이지를 띄울 Nginx마저 먹통이 되버리기 때문에 사용자 입장에서는 ???스러울 수 밖에 없음</em> </p>
<hr />
<h2 id="_1">분리 배포 방식으로 변경</h2>
<p>프로젝트 기간 중 멘토링을 받을 수 있는 시간이 있었는데 인프라 쪽 경력이 있으신 프론트엔드 멘토 분의 조언이 <br>
결과적으로 큰 도움이 되었다. 멘토 분은 내가 했던 방식으로 하나의 인스턴스에 백엔드와 프론트엔드가 같이 <br>
공존하는 경우는 거의 없고 분리 배포를 해야 한다, 프론트 부분은 s3와 CloudFront를 사용하거나 vercel같은 툴을 
사용하는 게 통상적이다라는 부분이었다. <br></p>
<p>개인적으로 vercel을 사용해보니 불편하다고 생각이 들어 AWS에 있는 기능들을 많이 활용해보자 하는 차원에서
S3에 리액트 빌드 파일을 넣고 CloudFront로 정적페이지 배포를 하는 방식으로 진행했다. <br>
이로써 백엔드는 EC2 안에서 돌아가고 프론트엔드는 CloudFront에서 배포되어 분리 배포가 가능해졌다.<br></p>
<p>배포는 했으니 이제 HTTPS를 붙이기로 했다. <br>
CloudFront에서는 기본적으로 http -&gt; https 리다이렉션 기능이 있길래 AWS Certificate Manager(ACM)을 사용하면 
손쉽게 적용할 수 있었다. 다만 CloudFront에서 ACM은 N.Virginia리전 에서 발급 받은 것만 사용할 수 있어서
리전 변경 뒤 적용했다. <br></p>
<div class="highlight"><pre><span></span><code>ACM
</code></pre></div>
<div class="result">
<p><img alt="ACM" class="align-center" src="../../../../../assets/images/22-10-26-https/ACM.jpg" title="ACM" /></p>
</div>
<p><br>
스프링은 Certbot에서 받은 키로 https, CloudFront에서도 https가 적용되었기 때문에 이제 다 되었다고 생각했다.
하지만 테스트 결과 인증서가 불일치한다는 오류가 자꾸 나왔다. 서버 쪽에서 다른 조치를 해보기로 했다. </p>
<hr />
<h2 id="https-http">https - http 통신?</h2>
<p>내가 얻은 결론은 일단 인증서 발급 주체를 통일해야 하는 것이었다. 따라서 고민하면서 생각해본 방법은 다음과 같았다.<br></p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<ol>
<li>EC2를 하나 더 만들어 프론트, 백 분리해서 배포하고 Certbot 각각 적용하는 방식 </li>
<li>ACM을 파일로 받아서 스프링에 넣고 돌리는 방식</li>
</ol>
</div>
<p>1번은 말은 되었지만 프리티어를 사용하고 있었기에 과금의 부담이 있어 포기했고 2번은 애초에 불가능했다.<br>
ACM은 pem이나 ppk처럼 파일형식으로 받을 수 없다고 한다. <a href="https://stackoverflow.com/questions/57562148/how-to-download-a-public-certificate-from-amazon-certificate-manager">[링크]</a> <br></p>
<p>그렇게 2일 정도를 계속 구글링만 하다가 nginx를 활용하는 다른 방법을 찾게 되었다. <br>
Reverse Proxy에 대한 키워드였는데 이걸 활용하면 Certbot 없이 서버의 http와 프론트의 https가 통신이 가능해 보였다. </p>
<p>간단하게 보면, https요청이 들어오면 해당 요청을 nginx에서 먼저 받은 뒤에 정해진 스프링 서버로 보내버리는 방식이다.
이를 위해서는 Route 53에 추가설정을 해야 하고 LoadBalancer를 사용해야 했다. <br></p>
<p>해당 키워드를 알고 나니 검색이 훨씬 수월했고 내가 원하는 자료들도 쏟아져 나오기 시작했다. 마치 금광 같았던..<br></p>
<hr />
<h2 id="loadbalancer-route-53">LoadBalancer와 Route 53</h2>
<p>이번 프로젝트에서는 woodongs.site 도메인을 가비아에서 구입해 사용했다. (우동스 - 우리 동네 스터디 ....)<br>
따라서 가비아와 AWS연동을 위해 Route53에서 <code>[woodongs.site]</code>도메인에 대한 설정은 이미 되어있는 상황이었고 
CloudFront 에서 <code>[www.woodongs.site]</code>으로 Alternate domain을 설정해놨다. <br></p>
<p>이제 <code>[https://www.woodongs.site]</code>에서 <code>{EC2 ip주소}:8080</code>으로 https 요청을 보내기만 하면 됐었다.  <br></p>
<p>처음에는 바로 <code>[woodongs.site]</code>로 보내고 싶었으나 통신이 되지 않았다. 정확한 원인은 파악할 수 없었으나 <br>
ACM의 발급 대상을<code>*.woodongs.site</code>로 해놨었기 때문에 정황상 https가 적용되지 않아서 그런 것 같다. <br></p>
<p>이부분에서 삽질을 굉장히 많이 했었는데 할 때마다 프론트 코드의 URL 부분을 바꿔야 하는 경우가 빈번했고 그때마다 
프론트 분들에게 요청하기 죄송해서 차라리 내가 프론트분들 코드를 받아 수정하고 빌드 하면서 테스트 하는 식으로
진행했다. 덕분에 리액트 프로젝트를 실행하고 빌드하는 법도 익히게 된 것 같다.<br></p>
<p>여러 고민과 구글링 끝에 리액트에서 서버로 보내는 모든 요청을 <code>[https://api.woodongs.site]</code>로 통일해서 보내기로 했다.<br></p>
<p>여기서 LoadBalancer를 추가했고 http요청이 오면 https로 바꿔주고 https요청은 EC2 ip주소의 80번 포트로 넘기도록
Target Group까지 설정해놓았다. <br><br></p>
<div class="highlight"><pre><span></span><code>Load Balancer
</code></pre></div>
<div class="result">
<p><img alt="LoadBalancer" class="align-center" src="../../../../../assets/images/22-10-26-https/loadbalancer.jpg" title="LoadBalancer" /></p>
</div>
<p><br>
여기까지 오면 클라이언트가 서버로 요청을 막 보낸 단계가 된다. 이 다음부터는 EC2 내부에서 일을 처리해야 하는데 
여기서 Nginx가 사용된다. LoadBalancer를 통해서 80번 포트로 EC2에 요청이 오게되면 <strong>Nginx가 먼저 요청을 받은뒤</strong> 
<strong>스프링 서버로 넘기는 Reverse Proxy 역할</strong>을 한다. <br><br></p>
<div class="highlight"><pre><span></span><code>Nginx
</code></pre></div>
<div class="result">
<p><img alt="Nginx" class="align-center" src="../../../../../assets/images/22-10-26-https/nginx.jpg" title="Nginx" /></p>
</div>
<p><br>
기존의 프론트에서 바로 서버와 통신하는 방식이 되지 않아 다른 방법을 찾던 도중 적용하게 된 방식이지만 <br>
<strong>리버스 프록시를 사용하면 서버가 노출될 일이 적어서 안정성 측면에서 더 낫다</strong>고 하니 뜻밖의 이득인듯. <br></p>
<p>여기서 특이점은 Spring서버 자체는 http로 동작하고 있다는 사실이다. <br>
이상적으로는 Spring서버에도 HTTPS를 붙여야 하지만 시간상 하지 못했었고 작동하는데 건들였다가 또 안될까봐 
무서운것도 컸다. 유난히 이번 프로젝트때 이거 해볼까? 하고 건들였다가 다 안되서 고치느라 시간 낭비를 많이했다. <br>  </p>
<h2 id="_2">전체 흐름으로 보기</h2>
<div class="highlight"><pre><span></span><code>Overview
</code></pre></div>
<div class="result">
<p><img alt="Infra" class="align-center" src="../../../../../assets/images/22-10-26-https/infrafin.jpg" title="Infra" /></p>
</div>
<p>전체적인 흐름을 도식화해서 본다면 아래와 같을 것이다.<br></p>
<ol>
<li>사용자가 <code>[www.woodongs.site]</code>로 접속한다.</li>
<li><code>[www.woodongs.site]</code>는 Route53을 통해 CloudFront의 정적페이지를 보여준다. </li>
<li>CloudFront에서 <code>[https://api.woodongs.site]</code>로 요청을 보낸다.</li>
<li>Route53에서 설정한 대로 <code>[https://api.woodongs.site]</code>는 로드밸런서로 이동</li>
<li>로드밸런서에서 해당 요청이 http면 https로 리다이렉트, https면 ec2에 80번 포트로 요청을 보낸다.</li>
<li>nginx에서 80번 포트로 <code>[https://api.woodongs.site]</code>에서 요청이 들어오면 EC2 ip의 8080포트로 보낸다.</li>
</ol>







  
  



  


  



      
    </article>
  </div>

          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Dan Choi
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/daihan-ch22" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.sections", "navigation.top", "navigation.path", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.select", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>